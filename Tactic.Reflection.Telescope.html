<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Reflection.Telescope</title><link rel="stylesheet" href="Agda.css"></head><body><pre>
<a id="2" class="Keyword">module</a> <a id="9" href="Tactic.Reflection.Telescope.html" class="Module">Tactic.Reflection.Telescope</a> <a id="37" class="Keyword">where</a>

<a id="44" class="Keyword">open</a> <a id="49" class="Keyword">import</a> <a id="56" href="Prelude.html" class="Module">Prelude</a> <a id="64" class="Keyword">hiding</a> <a id="71" class="Symbol">(</a><a id="72" href="Prelude.Int.Core.html#1244" class="Function">abs</a><a id="75" class="Symbol">)</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Builtin.Reflection.html" class="Module">Builtin.Reflection</a>
<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Tactic.Reflection.DeBruijn.html" class="Module">Tactic.Reflection.DeBruijn</a>

<a id="Telescope"></a><a id="148" href="Tactic.Reflection.Telescope.html#148" class="Function">Telescope</a> <a id="158" class="Symbol">=</a> <a id="160" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="165" class="Symbol">(</a><a id="166" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="170" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a><a id="174" class="Symbol">)</a>

<a id="telView"></a><a id="177" href="Tactic.Reflection.Telescope.html#177" class="Function">telView</a> <a id="185" class="Symbol">:</a> <a id="187" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a> <a id="192" class="Symbol">→</a> <a id="194" href="Tactic.Reflection.Telescope.html#148" class="Function">Telescope</a> <a id="204" href="Prelude.Product.html#337" class="Function Operator">×</a> <a id="206" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a>
<a id="211" href="Tactic.Reflection.Telescope.html#177" class="Function">telView</a> <a id="219" class="Symbol">(</a><a id="220" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="223" href="Tactic.Reflection.Telescope.html#223" class="Bound">a</a> <a id="225" class="Symbol">(</a><a id="226" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="230" class="Symbol">_</a> <a id="232" href="Tactic.Reflection.Telescope.html#232" class="Bound">b</a><a id="233" class="Symbol">))</a> <a id="236" class="Symbol">=</a> <a id="238" href="Prelude.Product.html#1439" class="Function">first</a> <a id="244" class="Symbol">(</a><a id="245" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a> <a id="249" href="Tactic.Reflection.Telescope.html#223" class="Bound">a</a><a id="250" class="Symbol">)</a> <a id="252" class="Symbol">(</a><a id="253" href="Tactic.Reflection.Telescope.html#177" class="Function">telView</a> <a id="261" href="Tactic.Reflection.Telescope.html#232" class="Bound">b</a><a id="262" class="Symbol">)</a>
<a id="264" href="Tactic.Reflection.Telescope.html#177" class="CatchallClause Function">telView</a><a id="271" class="CatchallClause"> </a><a id="272" href="Tactic.Reflection.Telescope.html#272" class="CatchallClause Bound">a</a>                <a id="289" class="Symbol">=</a> <a id="291" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="294" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="296" href="Tactic.Reflection.Telescope.html#272" class="Bound">a</a>

<a id="visibleArity"></a><a id="299" href="Tactic.Reflection.Telescope.html#299" class="Function">visibleArity</a> <a id="312" class="Symbol">:</a> <a id="314" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a> <a id="319" class="Symbol">→</a> <a id="321" href="Agda.Builtin.Nat.html#97" class="Datatype">Nat</a>
<a id="325" href="Tactic.Reflection.Telescope.html#299" class="Function">visibleArity</a> <a id="338" class="Symbol">=</a> <a id="340" href="Prelude.List.html#777" class="Function">length</a> <a id="347" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="349" href="Prelude.List.html#1563" class="Function">filter</a> <a id="356" href="Builtin.Reflection.html#3132" class="Function">isVisible</a> <a id="366" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="368" href="Agda.Builtin.Sigma.html#155" class="Field">fst</a> <a id="372" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="374" href="Tactic.Reflection.Telescope.html#177" class="Function">telView</a>

<a id="telPi"></a><a id="383" href="Tactic.Reflection.Telescope.html#383" class="Function">telPi</a> <a id="389" class="Symbol">:</a> <a id="391" href="Tactic.Reflection.Telescope.html#148" class="Function">Telescope</a> <a id="401" class="Symbol">→</a> <a id="403" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a> <a id="408" class="Symbol">→</a> <a id="410" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a>
<a id="415" href="Tactic.Reflection.Telescope.html#383" class="Function">telPi</a> <a id="421" href="Tactic.Reflection.Telescope.html#421" class="Bound">tel</a> <a id="425" href="Tactic.Reflection.Telescope.html#425" class="Bound">b</a> <a id="427" class="Symbol">=</a> <a id="429" href="Prelude.List.html#872" class="Function">foldr</a> <a id="435" class="Symbol">(λ</a> <a id="438" href="Tactic.Reflection.Telescope.html#438" class="Bound">a</a> <a id="440" href="Tactic.Reflection.Telescope.html#440" class="Bound">b</a> <a id="442" class="Symbol">→</a> <a id="444" href="Agda.Builtin.Reflection.html#4880" class="InductiveConstructor">pi</a> <a id="447" href="Tactic.Reflection.Telescope.html#438" class="Bound">a</a> <a id="449" class="Symbol">(</a><a id="450" href="Agda.Builtin.Reflection.html#3308" class="InductiveConstructor">abs</a> <a id="454" class="String">&quot;_&quot;</a> <a id="458" href="Tactic.Reflection.Telescope.html#440" class="Bound">b</a><a id="459" class="Symbol">))</a> <a id="462" href="Tactic.Reflection.Telescope.html#425" class="Bound">b</a> <a id="464" href="Tactic.Reflection.Telescope.html#421" class="Bound">tel</a>

<a id="arity"></a><a id="469" href="Tactic.Reflection.Telescope.html#469" class="Function">arity</a> <a id="475" class="Symbol">:</a> <a id="477" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="482" class="Symbol">→</a> <a id="484" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="487" href="Agda.Builtin.Nat.html#97" class="Datatype">Nat</a>
<a id="491" href="Tactic.Reflection.Telescope.html#469" class="Function">arity</a> <a id="497" href="Tactic.Reflection.Telescope.html#497" class="Bound">f</a> <a id="499" class="Symbol">=</a> <a id="501" href="Prelude.List.html#777" class="Function">length</a> <a id="508" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="510" href="Agda.Builtin.Sigma.html#155" class="Field">fst</a> <a id="514" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="516" href="Tactic.Reflection.Telescope.html#177" class="Function">telView</a> <a id="524" href="Prelude.Functor.html#257" class="Function Operator">&lt;$&gt;</a> <a id="528" href="Agda.Builtin.Reflection.html#8043" class="Postulate">getType</a> <a id="536" href="Tactic.Reflection.Telescope.html#497" class="Bound">f</a>

<a id="argTel"></a><a id="539" href="Tactic.Reflection.Telescope.html#539" class="Function">argTel</a> <a id="546" class="Symbol">:</a> <a id="548" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="553" class="Symbol">→</a> <a id="555" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="558" href="Tactic.Reflection.Telescope.html#148" class="Function">Telescope</a>
<a id="568" href="Tactic.Reflection.Telescope.html#539" class="Function">argTel</a> <a id="575" href="Tactic.Reflection.Telescope.html#575" class="Bound">f</a> <a id="577" class="Symbol">=</a> <a id="579" href="Agda.Builtin.Sigma.html#155" class="Field">fst</a> <a id="583" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="585" href="Tactic.Reflection.Telescope.html#177" class="Function">telView</a> <a id="593" href="Prelude.Functor.html#257" class="Function Operator">&lt;$&gt;</a> <a id="597" href="Agda.Builtin.Reflection.html#8043" class="Postulate">getType</a> <a id="605" href="Tactic.Reflection.Telescope.html#575" class="Bound">f</a>

<a id="telePat"></a><a id="608" href="Tactic.Reflection.Telescope.html#608" class="Function">telePat</a> <a id="616" class="Symbol">:</a> <a id="618" href="Tactic.Reflection.Telescope.html#148" class="Function">Telescope</a> <a id="628" class="Symbol">→</a> <a id="630" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="635" class="Symbol">(</a><a id="636" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="640" href="Agda.Builtin.Reflection.html#4005" class="Datatype">Pattern</a><a id="647" class="Symbol">)</a>
<a id="649" href="Tactic.Reflection.Telescope.html#608" class="Function">telePat</a> <a id="657" class="Symbol">=</a> <a id="659" href="Prelude.List.html#555" class="Function">map</a> <a id="663" class="Symbol">(</a><a id="664" href="Agda.Builtin.Reflection.html#4104" class="InductiveConstructor">var</a> <a id="668" class="String">&quot;_&quot;</a> <a id="672" href="Prelude.Functor.html#273" class="Function Operator">&lt;$_</a><a id="675" class="Symbol">)</a>

<a id="678" class="Keyword">private</a>
  <a id="teleArgs′"></a><a id="688" href="Tactic.Reflection.Telescope.html#688" class="Function">teleArgs′</a> <a id="698" class="Symbol">:</a> <a id="700" href="Agda.Builtin.Nat.html#97" class="Datatype">Nat</a> <a id="704" class="Symbol">→</a> <a id="706" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="711" class="Symbol">(</a><a id="712" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="716" href="Agda.Builtin.Reflection.html#4561" class="Function">Type</a><a id="720" class="Symbol">)</a> <a id="722" class="Symbol">→</a> <a id="724" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="729" class="Symbol">(</a><a id="730" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="734" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="738" class="Symbol">)</a>
  <a id="742" href="Tactic.Reflection.Telescope.html#688" class="Function">teleArgs′</a> <a id="752" class="Symbol">(</a><a id="753" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="757" href="Tactic.Reflection.Telescope.html#757" class="Bound">n</a><a id="758" class="Symbol">)</a> <a id="760" class="Symbol">(</a><a id="761" href="Tactic.Reflection.Telescope.html#761" class="Bound">a</a> <a id="763" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="765" href="Tactic.Reflection.Telescope.html#765" class="Bound">Γ</a><a id="766" class="Symbol">)</a> <a id="768" class="Symbol">=</a> <a id="770" class="Symbol">(</a><a id="771" href="Agda.Builtin.Reflection.html#4592" class="InductiveConstructor">var</a> <a id="775" href="Tactic.Reflection.Telescope.html#757" class="Bound">n</a> <a id="777" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="780" href="Prelude.Functor.html#273" class="Function Operator">&lt;$</a> <a id="783" href="Tactic.Reflection.Telescope.html#761" class="Bound">a</a><a id="784" class="Symbol">)</a> <a id="786" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="788" href="Tactic.Reflection.Telescope.html#688" class="Function">teleArgs′</a> <a id="798" href="Tactic.Reflection.Telescope.html#757" class="Bound">n</a> <a id="800" href="Tactic.Reflection.Telescope.html#765" class="Bound">Γ</a>
  <a id="804" href="Tactic.Reflection.Telescope.html#688" class="CatchallClause Function">teleArgs′</a><a id="813" class="CatchallClause"> </a><a id="814" class="CatchallClause Symbol">_</a><a id="815" class="CatchallClause"> </a><a id="816" class="CatchallClause Symbol">_</a> <a id="818" class="Symbol">=</a> <a id="820" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>

<a id="teleArgs"></a><a id="824" href="Tactic.Reflection.Telescope.html#824" class="Function">teleArgs</a> <a id="833" class="Symbol">:</a> <a id="835" href="Tactic.Reflection.Telescope.html#148" class="Function">Telescope</a> <a id="845" class="Symbol">→</a> <a id="847" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="852" class="Symbol">(</a><a id="853" href="Agda.Builtin.Reflection.html#3041" class="Datatype">Arg</a> <a id="857" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a><a id="861" class="Symbol">)</a>
<a id="863" href="Tactic.Reflection.Telescope.html#824" class="Function">teleArgs</a> <a id="872" href="Tactic.Reflection.Telescope.html#872" class="Bound">Γ</a> <a id="874" class="Symbol">=</a> <a id="876" href="Tactic.Reflection.Telescope.html#688" class="Function">teleArgs′</a> <a id="886" class="Symbol">(</a><a id="887" href="Prelude.List.html#777" class="Function">length</a> <a id="894" href="Tactic.Reflection.Telescope.html#872" class="Bound">Γ</a><a id="895" class="Symbol">)</a> <a id="897" href="Tactic.Reflection.Telescope.html#872" class="Bound">Γ</a>

<a id="conParams"></a><a id="900" href="Tactic.Reflection.Telescope.html#900" class="Function">conParams</a> <a id="910" class="Symbol">:</a> <a id="912" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="917" class="Symbol">→</a> <a id="919" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="922" href="Agda.Builtin.Nat.html#97" class="Datatype">Nat</a>
<a id="926" href="Tactic.Reflection.Telescope.html#900" class="Function">conParams</a> <a id="936" href="Tactic.Reflection.Telescope.html#936" class="Bound">c</a> <a id="938" class="Symbol">=</a>
  <a id="942" href="Prelude.Monad.html#1611" class="Function Operator">caseM</a> <a id="948" href="Agda.Builtin.Reflection.html#8076" class="Postulate">getDefinition</a> <a id="962" href="Tactic.Reflection.Telescope.html#936" class="Bound">c</a> <a id="964" href="Prelude.Monad.html#1611" class="Function Operator">of</a> <a id="967" class="Symbol">λ</a>
  <a id="971" class="Symbol">{</a> <a id="973" class="Symbol">(</a><a id="974" href="Agda.Builtin.Reflection.html#6309" class="InductiveConstructor">data-cons</a> <a id="984" href="Tactic.Reflection.Telescope.html#984" class="Bound">d</a><a id="985" class="Symbol">)</a> <a id="987" class="Symbol">→</a> <a id="989" href="Builtin.Reflection.html#5160" class="Function">getParameters</a> <a id="1003" href="Tactic.Reflection.Telescope.html#984" class="Bound">d</a>
  <a id="1007" class="Symbol">;</a> <a id="1009" class="CatchallClause Symbol">_</a>             <a id="1023" class="Symbol">→</a> <a id="1025" href="Prelude.Applicative.html#371" class="Field">pure</a> <a id="1030" class="Number">0</a> <a id="1032" class="Symbol">}</a>

<a id="conPat"></a><a id="1035" href="Tactic.Reflection.Telescope.html#1035" class="Function">conPat</a> <a id="1042" class="Symbol">:</a> <a id="1044" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="1049" class="Symbol">→</a> <a id="1051" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="1054" href="Agda.Builtin.Reflection.html#4005" class="Datatype">Pattern</a>
<a id="1062" href="Tactic.Reflection.Telescope.html#1035" class="Function">conPat</a> <a id="1069" href="Tactic.Reflection.Telescope.html#1069" class="Bound">c</a> <a id="1071" class="Symbol">=</a> <a id="1073" class="Keyword">do</a>
  <a id="1078" href="Tactic.Reflection.Telescope.html#1078" class="Bound">np</a> <a id="1081" href="Prelude.Monad.html#262" class="Field Operator">←</a> <a id="1083" href="Tactic.Reflection.Telescope.html#900" class="Function">conParams</a> <a id="1093" href="Tactic.Reflection.Telescope.html#1069" class="Bound">c</a>
  <a id="1097" href="Agda.Builtin.Reflection.html#4027" class="InductiveConstructor">con</a> <a id="1101" href="Tactic.Reflection.Telescope.html#1069" class="Bound">c</a> <a id="1103" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="1105" href="Tactic.Reflection.Telescope.html#608" class="Function">telePat</a> <a id="1113" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="1115" href="Prelude.List.html#2237" class="Function">drop</a> <a id="1120" href="Tactic.Reflection.Telescope.html#1078" class="Bound">np</a> <a id="1123" href="Prelude.Functor.html#257" class="Function Operator">&lt;$&gt;</a> <a id="1127" href="Tactic.Reflection.Telescope.html#539" class="Function">argTel</a> <a id="1134" href="Tactic.Reflection.Telescope.html#1069" class="Bound">c</a>

<a id="conTerm"></a><a id="1137" href="Tactic.Reflection.Telescope.html#1137" class="Function">conTerm</a> <a id="1145" class="Symbol">:</a> <a id="1147" href="Agda.Builtin.Reflection.html#363" class="Postulate">Name</a> <a id="1152" class="Symbol">→</a> <a id="1154" href="Agda.Builtin.Reflection.html#7153" class="Postulate">TC</a> <a id="1157" href="Agda.Builtin.Reflection.html#4548" class="Datatype">Term</a>
<a id="1162" href="Tactic.Reflection.Telescope.html#1137" class="Function">conTerm</a> <a id="1170" href="Tactic.Reflection.Telescope.html#1170" class="Bound">c</a> <a id="1172" class="Symbol">=</a> <a id="1174" class="Keyword">do</a>
  <a id="1179" href="Tactic.Reflection.Telescope.html#1179" class="Bound">np</a> <a id="1182" href="Prelude.Monad.html#262" class="Field Operator">←</a> <a id="1184" href="Tactic.Reflection.Telescope.html#900" class="Function">conParams</a> <a id="1194" href="Tactic.Reflection.Telescope.html#1170" class="Bound">c</a>
  <a id="1198" href="Agda.Builtin.Reflection.html#4648" class="InductiveConstructor">con</a> <a id="1202" href="Tactic.Reflection.Telescope.html#1170" class="Bound">c</a> <a id="1204" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="1206" href="Tactic.Reflection.Telescope.html#824" class="Function">teleArgs</a> <a id="1215" href="Prelude.Function.html#376" class="Function Operator">∘</a> <a id="1217" href="Prelude.List.html#2237" class="Function">drop</a> <a id="1222" href="Tactic.Reflection.Telescope.html#1179" class="Bound">np</a> <a id="1225" href="Prelude.Functor.html#257" class="Function Operator">&lt;$&gt;</a> <a id="1229" href="Tactic.Reflection.Telescope.html#539" class="Function">argTel</a> <a id="1236" href="Tactic.Reflection.Telescope.html#1170" class="Bound">c</a>
</pre></body></html>